-# encoding: utf-8
%h1 Étape&nbsp;2&nbsp;: Correspondance des colonnes
%p
  Il faut mettre en face de chaque colonne sa correspondance. Une reconnaissance triviale est effectuée automatiquement en fonction des en-têtes de colonne.
%p
  %strong Remarque&nbsp;: 
  Par défaut, le nombre d'exemplaire sera de 1 si rien n'est spécifié.

-if @messages
  .errors
    %p Des problèmes ont été rencontrés&nbsp;:
    %ul
      -for message in @messages
        %li
          %p=message

=form_tag({:force=>!@messages.nil?}) do
  %fieldset
    %legend Colonnes
    %table.formic
      -@headers.each_with_index do |header, index|
        %tr.column
          %td.label=header
          %td.input=select_tag("headers[#{index}]", options_for_select(@columns, @reversed_columns[header.codeize]))
          %td.example=@first_line[index]

  %fieldset
    %legend Options
    %table.formic
      %tr
        %td.label Préfixe N°Abonné
        %td.input=text_field_tag("subscriber_prefix")
      %tr
        %td.label Nom du fichier à exporter
        %td.input=text_field_tag("export_file", params["export_file"])
      
  .actions
    -if @messages
      =submit_tag("Exporter quand même!")
    -else
      =submit_tag("Exporter")
    =link_to("Retour à l'étape 1", :action=>:upload)
